---
title: "CodesLukas1306"
author: "Lukas"
date: '2022-06-13'
output: html_document
---t
---

# Load packages

```{r}
library("tidyverse")
library("psych")
library("pheatmap")
library("ggpubr")
library("patchwork")
library("ghibli")
library("reprex")
library("ggh4x")
library("ggplot2")
lit_path <-"C:/Users/lukwolt/Documents/R/LIT/"
ot_path <-"C:/Users/lukwolt/Documents/R/OT/"

ghibli_palettes$YesterdayMedium

```

# Load data
8ms
```{r}
#Turbo_1ng_8ms
LITDIA_Turbo_1_8ms <- read.csv2(paste0(lit_path, "20220420_LIT_Turbo_DIA_1ng_40SPD_whisper100_1CV_8ms.csv"))

#Turbo_5ng_8ms
LITDIA_Turbo_5_8ms <- read.csv2(paste0(lit_path, "20220420_LIT_Turbo_DIA_5ng_40SPD_whisper100_1CV_8ms.csv"))

#Turbo_10ng_8ms
LITDIA_Turbo_10_8ms <- read.csv2(paste0(lit_path, "20220420_LIT_Turbo_DIA_10ng_40SPD_whisper100_1CV_8ms.csv"))

#Turbo_100ng_8ms
LITDIA_Turbo_100_8ms <- read.csv2(paste0(lit_path, "20220420_LIT_Turbo_DIA_100ng_40SPD_whisper100_1CV_8ms.csv"))

```

16ms
```{r}
#Turbo_1ng_16ms
LITDIA_Turbo_1_16ms <- read.csv2(paste0(lit_path, "20220502_LIT_Turbo_DIA_1ng_40SPD_whisper100_1CV_auto.csv"))

#Turbo_5ng_16ms
LITDIA_Turbo_5_16ms <- read.csv2(paste0(lit_path, "20220502_LIT_Turbo_DIA_5ng_40SPD_whisper100_1CV_auto.csv"))

#Turbo_10ng_16ms
LITDIA_Turbo_10_16ms <- read.csv2(paste0(lit_path, "20220502_LIT_Turbo_DIA_10ng_40SPD_whisper100_1CV_auto.csv"))

#Turbo_100ng_16ms
LITDIA_Turbo_100_16ms <- read.csv2(paste0(lit_path, "20220502_LIT_Turbo_DIA_100ng_40SPD_whisper100_1CV_auto.csv"))

```

23ms
23ms_turbo
```{r}
#Turbo_1ng_23ms
LITDIA_Turbo_1_23ms <- read.csv2(paste0(lit_path, "20220219_LIT_Turbo_DIA_1ng_40SPD_whisper100_1CV_23ms.csv"))

#Turbo_5ng_23ms
LITDIA_Turbo_5_23ms <- read.csv2(paste0(lit_path, "20220524_LIT_Turbo_DIA_5ng_40SPD_whisper100_1CV_23ms.csv"))

#Turbo_10ng_23ms
LITDIA_Turbo_10_23ms <- read.csv2(paste0(lit_path, "20220524_LIT_Turbo_DIA_10ng_40SPD_whisper100_1CV_23ms.csv"))

#Turbo_100ng_23ms
LITDIA_Turbo_100_23ms <- read.csv2(paste0(lit_path, "20220525_LIT_Turbo_DIA_100ng_40SPD_whisper100_1CV_23ms.csv"))

```

23ms_rapid
```{r}
#Rapid_1ng_23ms
LITDIA_Rapid_1_23ms <- read.csv2(paste0(lit_path, "20220421_LIT_Rapid_DIA_1ng_40SPD_whisper100_1CV_auto.csv"))

#Rapid_5ng_23ms
LITDIA_Rapid_5_23ms <- read.csv2(paste0(lit_path, "20220502_LIT_Rapid_DIA_5ng_40SPD_whisper100_1CV_auto.csv"))

#Rapid_10ng_23ms
LITDIA_Rapid_10_23ms <- read.csv2(paste0(lit_path, "20220502_LIT_Rapid_DIA_10ng_40SPD_whisper100_1CV_auto.csv"))

#Rapid_100ng_23ms
LITDIA_Rapid_100_23ms <- read.csv2(paste0(lit_path, "20220421_LIT_Rapid_DIA_100ng_40SPD_whisper100_1CV_auto.csv"))

```

38ms
38ms_turbo
```{r}
#Turbo_1ng_38ms
LITDIA_Turbo_1_38ms <- read.csv2(paste0(lit_path, "20220525_LIT_Turbo_DIA_1ng_40SPD_whisper100_1CV_38ms.csv"))

#Turbo_5ng_38ms
LITDIA_Turbo_5_38ms <- read.csv2(paste0(lit_path, "20220525_LIT_Turbo_DIA_5ng_40SPD_whisper100_1CV_38ms.csv"))

#Turbo_10ng_38ms
LITDIA_Turbo_10_38ms <- read.csv2(paste0(lit_path, "20220525_LIT_Turbo_DIA_10ng_40SPD_whisper100_1CV_38ms.csv"))

#Turbo_100ng_38ms
LITDIA_Turbo_100_38ms <- read.csv2(paste0(lit_path, "20220525_LIT_Turbo_DIA_100ng_40SPD_whisper100_1CV_38ms.csv"))

```

38ms_rapid
```{r}
#Rapid_1ng_38ms
LITDIA_Rapid_1_38ms <- read.csv2(paste0(lit_path, "20220525_LIT_Rapid_DIA_1ng_40SPD_whisper100_1CV_38ms.csv"))

#Rapid_5ng_38ms
LITDIA_Rapid_5_38ms <- read.csv2(paste0(lit_path, "20220525_LIT_Rapid_DIA_5ng_40SPD_whisper100_1CV_38ms_40SPD_File1.csv"))

#Rapid_10ng_38ms
LITDIA_Rapid_10_38ms <- read.csv2(paste0(lit_path, "20220525_LIT_Rapid_DIA_10ng_40SPD_whisper100_1CV_38ms.csv"))

#Rapid_100ng_38ms
LITDIA_Rapid_100_38ms <- read.csv2(paste0(lit_path, "20220525_LIT_Rapid_DIA_100ng_40SPD_whisper100_1CV_38ms.csv"))

```

38ms_normal
```{r}
#Normal_1ng_38ms
LITDIA_Normal_1_38ms <- read.csv2(paste0(lit_path, "20220421_LIT_Normal_DIA_1ng_40SPD_whisper100_1CV_auto.csv"))

#Normal_5ng_38ms
LITDIA_Normal_5_38ms <- read.csv2(paste0(lit_path, "20220502_LIT_Normal_DIA_5ng_40SPD_whisper100_1CV_auto.csv"))

#Normal_10ng_38ms
LITDIA_Normal_10_38ms <- read.csv2(paste0(lit_path, "20220502_LIT_Normal_DIA_10ng_40SPD_whisper100_1CV_auto.csv"))

#Normal_100ng_38ms
LITDIA_Normal_100_38ms <- read.csv2(paste0(lit_path, "20220421_LIT_Normal_DIA_100ng_40SPD_whisper100_1CV_auto.csv"))

```

# Remove peptides found in less than 3 replicates

8ms clean
```{r}
LITDIA_Turbo_1_8ms <-  filter_pep(LITDIA_Turbo_1_8ms)
LITDIA_Turbo_5_8ms <-  filter_pep(LITDIA_Turbo_5_8ms)
LITDIA_Turbo_10_8ms <-  filter_pep(LITDIA_Turbo_10_8ms)
LITDIA_Turbo_100_8ms <-  filter_pep(LITDIA_Turbo_100_8ms)

```
16ms clean
```{r}
LITDIA_Turbo_1_16ms <-  filter_pep(LITDIA_Turbo_1_16ms)
LITDIA_Turbo_5_16ms <-  filter_pep(LITDIA_Turbo_5_16ms)
LITDIA_Turbo_10_16ms <-  filter_pep(LITDIA_Turbo_10_16ms)
LITDIA_Turbo_100_16ms <-  filter_pep(LITDIA_Turbo_100_16ms)

```
23ms clean
23ms turbo clean
```{r}
LITDIA_Turbo_1_23ms <-  filter_pep(LITDIA_Turbo_1_23ms)
LITDIA_Turbo_5_23ms <-  filter_pep(LITDIA_Turbo_5_23ms)
LITDIA_Turbo_10_23ms <-  filter_pep(LITDIA_Turbo_10_23ms)
LITDIA_Turbo_100_23ms <-  filter_pep(LITDIA_Turbo_100_23ms)

```

23ms rapid clean
```{r}
LITDIA_Rapid_1_23ms <-  filter_pep(LITDIA_Rapid_1_23ms)
LITDIA_Rapid_5_23ms <-  filter_pep(LITDIA_Rapid_5_23ms)
LITDIA_Rapid_10_23ms <-  filter_pep(LITDIA_Rapid_10_23ms)
LITDIA_Rapid_100_23ms <-  filter_pep(LITDIA_Rapid_100_23ms)

```

38ms clean
38ms turbo clean
```{r}
LITDIA_Turbo_1_38ms <-  filter_pep(LITDIA_Turbo_1_38ms)
LITDIA_Turbo_5_38ms <-  filter_pep(LITDIA_Turbo_5_38ms)
LITDIA_Turbo_10_38ms <-  filter_pep(LITDIA_Turbo_10_38ms)
LITDIA_Turbo_100_38ms <-  filter_pep(LITDIA_Turbo_100_38ms)

```
38ms rapid clean
```{r}
LITDIA_Rapid_1_38ms <-  filter_pep(LITDIA_Rapid_1_38ms)
LITDIA_Rapid_5_38ms <-  filter_pep(LITDIA_Rapid_5_38ms)
LITDIA_Rapid_10_38ms <-  filter_pep(LITDIA_Rapid_10_38ms)
LITDIA_Rapid_100_38ms <-  filter_pep(LITDIA_Rapid_100_38ms)

```
38ms normal clean
```{r}
LITDIA_Normal_1_38ms <-  filter_pep(LITDIA_Normal_1_38ms)
LITDIA_Normal_5_38ms <-  filter_pep(LITDIA_Normal_5_38ms)
LITDIA_Normal_10_38ms <-  filter_pep(LITDIA_Normal_10_38ms)
LITDIA_Normal_100_38ms <-  filter_pep(LITDIA_Normal_100_38ms)

```

#Detect the number of identified peptides

```{r}
id_LITDIA_Turbo_1_8ms <- id_LITDIA_Turbo_5_8ms <- id_LITDIA_Turbo_10_8ms <- id_LITDIA_Turbo_100_8ms <- 
id_LITDIA_Turbo_1_16ms <- id_LITDIA_Turbo_5_16ms <- id_LITDIA_Turbo_10_16ms <- id_LITDIA_Turbo_100_16ms <- 
id_LITDIA_Turbo_1_23ms <- id_LITDIA_Turbo_5_23ms <- id_LITDIA_Turbo_10_23ms <- id_LITDIA_Turbo_100_23ms <-
id_LITDIA_Rapid_1_23ms <- id_LITDIA_Rapid_5_23ms <- id_LITDIA_Rapid_10_23ms <- id_LITDIA_Rapid_100_23ms <-
id_LITDIA_Turbo_1_38ms <- id_LITDIA_Turbo_5_38ms <- id_LITDIA_Turbo_10_38ms <- id_LITDIA_Turbo_100_38ms <-
id_LITDIA_Rapid_1_38ms <- id_LITDIA_Rapid_5_38ms <- id_LITDIA_Rapid_10_38ms <- id_LITDIA_Rapid_100_38ms <-
id_LITDIA_Normal_1_38ms <- id_LITDIA_Normal_5_38ms <- id_LITDIA_Normal_10_38ms <- id_LITDIA_Normal_100_38ms <-
  rep(NA, 4)
```

8ms
1ng
```{r}
for(i in 2:5){
  id_LITDIA_Turbo_1_8ms[i-1] <- sum(!is.na(LITDIA_Turbo_1_8ms[, i]))}
```

5ng
```{r}
for(i in 2:5){
  id_LITDIA_Turbo_5_8ms[i-1] <- sum(!is.na(LITDIA_Turbo_5_8ms[, i]))}
```

10ng
```{r}
for(i in 2:5){
  id_LITDIA_Turbo_10_8ms[i-1] <- sum(!is.na(LITDIA_Turbo_10_8ms[, i]))}
```

100ng
```{r}
for(i in 2:5){
  id_LITDIA_Turbo_100_8ms[i-1] <- sum(!is.na(LITDIA_Turbo_100_8ms[, i]))}
```

16ms
1ng
```{r}
for(i in 2:5){
  id_LITDIA_Turbo_1_16ms[i-1] <- sum(!is.na(LITDIA_Turbo_1_16ms[, i]))}
```

5ng
```{r}
for(i in 2:5){
  id_LITDIA_Turbo_5_16ms[i-1] <- sum(!is.na(LITDIA_Turbo_5_16ms[, i]))}
```

10ng
```{r}
for(i in 2:5){
  id_LITDIA_Turbo_10_16ms[i-1] <- sum(!is.na(LITDIA_Turbo_10_16ms[, i]))}
```

100ng
```{r}
for(i in 2:5){
  id_LITDIA_Turbo_100_16ms[i-1] <- sum(!is.na(LITDIA_Turbo_100_16ms[, i]))}
```

23ms
23ms turbo
1ng
```{r}
for(i in 2:5){
  id_LITDIA_Turbo_1_23ms[i-1] <- sum(!is.na(LITDIA_Turbo_1_23ms[, i]))}
```

5ng
```{r}
for(i in 2:5){
  id_LITDIA_Turbo_5_23ms[i-1] <- sum(!is.na(LITDIA_Turbo_5_23ms[, i]))}
```

10ng
```{r}
for(i in 2:5){
  id_LITDIA_Turbo_10_23ms[i-1] <- sum(!is.na(LITDIA_Turbo_10_23ms[, i]))}
```

100ng
```{r}
for(i in 2:5){
  id_LITDIA_Turbo_100_23ms[i-1] <- sum(!is.na(LITDIA_Turbo_100_23ms[, i]))}
```

23ms rapid
1ng
```{r}
for(i in 2:5){
  id_LITDIA_Rapid_1_23ms[i-1] <- sum(!is.na(LITDIA_Rapid_1_23ms[, i]))}
```

5ng
```{r}
for(i in 2:5){
  id_LITDIA_Rapid_5_23ms[i-1] <- sum(!is.na(LITDIA_Rapid_5_23ms[, i]))}
```

10ng
```{r}
for(i in 2:5){
  id_LITDIA_Rapid_10_23ms[i-1] <- sum(!is.na(LITDIA_Rapid_10_23ms[, i]))}
```

100ng
```{r} 
for(i in 2:5){
  id_LITDIA_Rapid_100_23ms[i-1] <- sum(!is.na(LITDIA_Rapid_100_23ms[, i]))}
```

38ms 
38ms turbo
1ng
```{r}
for(i in 2:5){
  id_LITDIA_Turbo_1_38ms[i-1] <- sum(!is.na(LITDIA_Turbo_1_38ms[, i]))}
```

5ng
```{r}
for(i in 2:5){
  id_LITDIA_Turbo_5_38ms[i-1] <- sum(!is.na(LITDIA_Turbo_5_38ms[, i]))}
```

10ng
```{r}
for(i in 2:5){
  id_LITDIA_Turbo_10_38ms[i-1] <- sum(!is.na(LITDIA_Turbo_10_38ms[, i]))}
```

100ng
```{r}
for(i in 2:5){
  id_LITDIA_Turbo_100_38ms[i-1] <- sum(!is.na(LITDIA_Turbo_100_38ms[, i]))}
```

38ms rapid
1ng
```{r}
for(i in 2:5){
  id_LITDIA_Rapid_1_38ms[i-1] <- sum(!is.na(LITDIA_Rapid_1_38ms[, i]))}
```

5ng
```{r}
for(i in 2:5){
  id_LITDIA_Rapid_5_38ms[i-1] <- sum(!is.na(LITDIA_Rapid_5_38ms[, i]))}
```

10ng
```{r}
for(i in 2:5){
  id_LITDIA_Rapid_10_38ms[i-1] <- sum(!is.na(LITDIA_Rapid_10_38ms[, i]))}
```

100ng
```{r} 
for(i in 2:5){
  id_LITDIA_Rapid_100_38ms[i-1] <- sum(!is.na(LITDIA_Rapid_100_38ms[, i]))}
```

38ms normal
1ng
```{r}
for(i in 2:5){
  id_LITDIA_Normal_1_38ms[i-1] <- sum(!is.na(LITDIA_Normal_1_38ms[, i]))}
```

5ng
```{r}
for(i in 2:5){
  id_LITDIA_Normal_5_38ms[i-1] <- sum(!is.na(LITDIA_Normal_5_38ms[, i]))}
```

10ng
```{r}
for(i in 2:5){
  id_LITDIA_Normal_10_38ms[i-1] <- sum(!is.na(LITDIA_Normal_10_38ms[, i]))}
```

100ng
```{r} 
for(i in 2:5){
  id_LITDIA_Normal_100_38ms[i-1] <- sum(!is.na(LITDIA_Normal_100_38ms[, i]))}
```

# Complement the table
```{r}
compute_CV <- function(x){
  y <- x %>% 
    mutate(sd = apply(x[, 2:(ncol(x)-2)],
                      FUN = sd, MARGIN =  1, na.rm = TRUE),
           CV = sd/mean_quantity)
  colnames(y)[2:(ncol(x)-2)] <- paste0("S", 1:(ncol(x)-3))
  if(ncol(x) <= 6){
  y$S4 <- NA
 }
  return(y)
}
```

8 ms
```{r}
LITDIA_Turbo_1_8ms_cv <- compute_CV(LITDIA_Turbo_1_8ms)
LITDIA_Turbo_1_8ms_cv$scanning_mode <- "Turbo"
LITDIA_Turbo_1_8ms_cv$injection_time<- "8 ms"
LITDIA_Turbo_1_8ms_cv$input<- "1 ng"

LITDIA_Turbo_5_8ms_cv <- compute_CV(LITDIA_Turbo_5_8ms)
LITDIA_Turbo_5_8ms_cv$scanning_mode <- "Turbo"
LITDIA_Turbo_5_8ms_cv$injection_time<- "8 ms"
LITDIA_Turbo_5_8ms_cv$input<- "5 ng"

LITDIA_Turbo_10_8ms_cv <- compute_CV(LITDIA_Turbo_10_8ms)
LITDIA_Turbo_10_8ms_cv$scanning_mode <- "Turbo"
LITDIA_Turbo_10_8ms_cv$injection_time<- "8 ms"
LITDIA_Turbo_10_8ms_cv$input<- "10 ng"

LITDIA_Turbo_100_8ms_cv <- compute_CV(LITDIA_Turbo_100_8ms)
LITDIA_Turbo_100_8ms_cv$scanning_mode <- "Turbo"
LITDIA_Turbo_100_8ms_cv$injection_time<- "8 ms"
LITDIA_Turbo_100_8ms_cv$input<- "100 ng"
```
16 ms
```{r}
LITDIA_Turbo_1_16ms_cv <- compute_CV(LITDIA_Turbo_1_16ms)
LITDIA_Turbo_1_16ms_cv$scanning_mode <- "Turbo"
LITDIA_Turbo_1_16ms_cv$injection_time<- "16 ms"
LITDIA_Turbo_1_16ms_cv$input<- "1 ng"

LITDIA_Turbo_5_16ms_cv <- compute_CV(LITDIA_Turbo_5_16ms)
LITDIA_Turbo_5_16ms_cv$scanning_mode <- "Turbo"
LITDIA_Turbo_5_16ms_cv$injection_time<- "16 ms"
LITDIA_Turbo_5_16ms_cv$input<- "5 ng"

LITDIA_Turbo_10_16ms_cv <- compute_CV(LITDIA_Turbo_10_16ms)
LITDIA_Turbo_10_16ms_cv$scanning_mode <- "Turbo"
LITDIA_Turbo_10_16ms_cv$injection_time<- "16 ms"
LITDIA_Turbo_10_16ms_cv$input<- "10 ng"

LITDIA_Turbo_100_16ms_cv <- compute_CV(LITDIA_Turbo_100_16ms)
LITDIA_Turbo_100_16ms_cv$scanning_mode <- "Turbo"
LITDIA_Turbo_100_16ms_cv$injection_time<- "16 ms"
LITDIA_Turbo_100_16ms_cv$input<- "100 ng"
```
23 ms
```{r}
LITDIA_Turbo_1_23ms_cv <- compute_CV(LITDIA_Turbo_1_23ms)
LITDIA_Turbo_1_23ms_cv$scanning_mode <- "Turbo"
LITDIA_Turbo_1_23ms_cv$injection_time<- "23 ms"
LITDIA_Turbo_1_23ms_cv$input<- "1 ng"

LITDIA_Turbo_5_23ms_cv <- compute_CV(LITDIA_Turbo_5_23ms)
LITDIA_Turbo_5_23ms_cv$scanning_mode <- "Turbo"
LITDIA_Turbo_5_23ms_cv$injection_time<- "23 ms"
LITDIA_Turbo_5_23ms_cv$input<- "5 ng"

LITDIA_Turbo_10_23ms_cv <- compute_CV(LITDIA_Turbo_10_23ms)
LITDIA_Turbo_10_23ms_cv$scanning_mode <- "Turbo"
LITDIA_Turbo_10_23ms_cv$injection_time<- "23 ms"
LITDIA_Turbo_10_23ms_cv$input<- "10 ng"

LITDIA_Turbo_100_23ms_cv <- compute_CV(LITDIA_Turbo_100_23ms)
LITDIA_Turbo_100_23ms_cv$scanning_mode <- "Turbo"
LITDIA_Turbo_100_23ms_cv$injection_time<- "23 ms"
LITDIA_Turbo_100_23ms_cv$input<- "100 ng"

LITDIA_Rapid_1_23ms_cv <- compute_CV(LITDIA_Rapid_1_23ms)
LITDIA_Rapid_1_23ms_cv$scanning_mode <- "Rapid"
LITDIA_Rapid_1_23ms_cv$injection_time<- "23 ms"
LITDIA_Rapid_1_23ms_cv$input<- "1 ng"

LITDIA_Rapid_5_23ms_cv <- compute_CV(LITDIA_Rapid_5_23ms)
LITDIA_Rapid_5_23ms_cv$scanning_mode <- "Rapid"
LITDIA_Rapid_5_23ms_cv$injection_time<- "23 ms"
LITDIA_Rapid_5_23ms_cv$input<- "5 ng"

LITDIA_Rapid_10_23ms_cv <- compute_CV(LITDIA_Rapid_10_23ms)
LITDIA_Rapid_10_23ms_cv$scanning_mode <- "Rapid"
LITDIA_Rapid_10_23ms_cv$injection_time<- "23 ms"
LITDIA_Rapid_10_23ms_cv$input<- "10 ng"

LITDIA_Rapid_100_23ms_cv <- compute_CV(LITDIA_Rapid_100_23ms)
LITDIA_Rapid_100_23ms_cv$scanning_mode <- "Rapid"
LITDIA_Rapid_100_23ms_cv$injection_time<- "23 ms"
LITDIA_Rapid_100_23ms_cv$input<- "100 ng"
```
38 ms
```{r}
LITDIA_Turbo_1_38ms_cv <- compute_CV(LITDIA_Turbo_1_38ms)
LITDIA_Turbo_1_38ms_cv$scanning_mode <- "Turbo"
LITDIA_Turbo_1_38ms_cv$injection_time<- "38 ms"
LITDIA_Turbo_1_38ms_cv$input<- "1 ng"

LITDIA_Turbo_5_38ms_cv <- compute_CV(LITDIA_Turbo_5_38ms)
LITDIA_Turbo_5_38ms_cv$scanning_mode <- "Turbo"
LITDIA_Turbo_5_38ms_cv$injection_time<- "38 ms"
LITDIA_Turbo_5_38ms_cv$input<- "5 ng"

LITDIA_Turbo_10_38ms_cv <- compute_CV(LITDIA_Turbo_10_38ms)
LITDIA_Turbo_10_38ms_cv$scanning_mode <- "Turbo"
LITDIA_Turbo_10_38ms_cv$injection_time<- "38 ms"
LITDIA_Turbo_10_38ms_cv$input<- "10 ng"

LITDIA_Turbo_100_38ms_cv <- compute_CV(LITDIA_Turbo_100_38ms)
LITDIA_Turbo_100_38ms_cv$scanning_mode <- "Turbo"
LITDIA_Turbo_100_38ms_cv$injection_time<- "38 ms"
LITDIA_Turbo_100_38ms_cv$input<- "100 ng"

LITDIA_Rapid_1_38ms_cv <- compute_CV(LITDIA_Rapid_1_38ms)
LITDIA_Rapid_1_38ms_cv$scanning_mode <- "Rapid"
LITDIA_Rapid_1_38ms_cv$injection_time<- "38 ms"
LITDIA_Rapid_1_38ms_cv$input<- "1 ng"

LITDIA_Rapid_5_38ms_cv <- compute_CV(LITDIA_Rapid_5_38ms)
LITDIA_Rapid_5_38ms_cv$scanning_mode <- "Rapid"
LITDIA_Rapid_5_38ms_cv$injection_time<- "38 ms"
LITDIA_Rapid_5_38ms_cv$input<- "5 ng"

LITDIA_Rapid_10_38ms_cv <- compute_CV(LITDIA_Rapid_10_38ms)
LITDIA_Rapid_10_38ms_cv$scanning_mode <- "Rapid"
LITDIA_Rapid_10_38ms_cv$injection_time<- "38 ms"
LITDIA_Rapid_10_38ms_cv$input<- "10 ng"

LITDIA_Rapid_100_38ms_cv <- compute_CV(LITDIA_Rapid_100_38ms)
LITDIA_Rapid_100_38ms_cv$scanning_mode <- "Rapid"
LITDIA_Rapid_100_38ms_cv$injection_time<- "38 ms"
LITDIA_Rapid_100_38ms_cv$input<- "100 ng"

LITDIA_Normal_1_38ms_cv <- compute_CV(LITDIA_Normal_1_38ms)
LITDIA_Normal_1_38ms_cv$scanning_mode <- "Normal"
LITDIA_Normal_1_38ms_cv$injection_time<- "38 ms"
LITDIA_Normal_1_38ms_cv$input<- "1 ng"

LITDIA_Normal_5_38ms_cv <- compute_CV(LITDIA_Normal_5_38ms)
LITDIA_Normal_5_38ms_cv$scanning_mode <- "Normal"
LITDIA_Normal_5_38ms_cv$injection_time<- "38 ms"
LITDIA_Normal_5_38ms_cv$input<- "5 ng"

LITDIA_Normal_10_38ms_cv <- compute_CV(LITDIA_Normal_10_38ms)
LITDIA_Normal_10_38ms_cv$scanning_mode <- "Normal"
LITDIA_Normal_10_38ms_cv$injection_time<- "38 ms"
LITDIA_Normal_10_38ms_cv$input<- "10 ng"

LITDIA_Normal_100_38ms_cv <- compute_CV(LITDIA_Normal_100_38ms)
LITDIA_Normal_100_38ms_cv$scanning_mode <- "Normal"
LITDIA_Normal_100_38ms_cv$injection_time<- "38 ms"
LITDIA_Normal_100_38ms_cv$input<- "100 ng"
```

# Join to a table

```{r}
id_figure5 <- 
  rbind(LITDIA_Turbo_1_8ms_cv, LITDIA_Turbo_5_8ms_cv, LITDIA_Turbo_10_8ms_cv, 
        LITDIA_Turbo_100_8ms_cv, LITDIA_Turbo_1_16ms_cv, LITDIA_Turbo_5_16ms_cv, 
        LITDIA_Turbo_10_16ms_cv, LITDIA_Turbo_100_16ms_cv, LITDIA_Turbo_1_23ms_cv, 
        LITDIA_Turbo_5_23ms_cv, LITDIA_Turbo_10_23ms_cv, LITDIA_Turbo_100_23ms_cv, 
        LITDIA_Rapid_1_23ms_cv, LITDIA_Rapid_5_23ms_cv, LITDIA_Rapid_10_23ms_cv, 
        LITDIA_Rapid_100_23ms_cv, LITDIA_Turbo_1_38ms_cv, LITDIA_Turbo_5_38ms_cv, 
        LITDIA_Turbo_10_38ms_cv, LITDIA_Turbo_100_38ms_cv, LITDIA_Rapid_1_38ms_cv, 
        LITDIA_Rapid_5_38ms_cv, LITDIA_Rapid_10_38ms_cv, LITDIA_Rapid_100_38ms_cv, 
        LITDIA_Normal_1_38ms_cv, LITDIA_Normal_5_38ms_cv, LITDIA_Normal_10_38ms_cv, 
        LITDIA_Normal_100_38ms_cv)

id_figure5$scanning_mode %>% table()
id_figure5$injection_time %>% table()
id_figure5$input %>% table()

id_figure5$scanning_mode <- factor(id_figure5$scanning_mode, 
                          levels = unique(id_figure5$scanning_mode))

id_figure5$input <- factor(id_figure5$input, 
                          levels = unique(id_figure5$input))

id_figure5$injection_time <- factor(id_figure5$injection_time, 
                          levels = unique(id_figure5$injection_time))

id_figure5$CV_filter <- NA
id_figure5$CV_filter[id_figure5$CV < 0.1] <- "3"
id_figure5$CV_filter[id_figure5$CV >= 0.1 & id_figure5$CV <= 0.15] <- "2"
id_figure5$CV_filter[id_figure5$CV > 0.15] <- "1"

id_figure5 <- id_figure5 %>%
  filter(!is.na(CV_filter)) %>% 
  group_by(scanning_mode, injection_time, input, CV_filter) %>% 
  summarise(id_S1 = sum(!is.na(S1)),
            id_S2 = sum(!is.na(S2)),
            id_S3 = sum(!is.na(S3)),
            id_S4 = sum(!is.na(S4)))
id_figure5$id_S4[id_figure5$id_S4 == 0] <- NA 

id_figure5$mean_id <- rowMeans(id_figure5[5:8], na.rm = TRUE)
id_figure5$sd_id <- apply(id_figure5[5:8], FUN =  sd, MARGIN = 1, na.rm = TRUE)
```

# Plot 
Turbo
```{r}
id_figure5$y_errorbar <- id_figure5$mean_id
id_figure5$y_errorbar[id_figure5$CV_filter == "1"] <-
  id_figure5$y_errorbar[id_figure5$CV_filter == "1"] +
  id_figure5$y_errorbar[id_figure5$CV_filter == "2"]+
  id_figure5$y_errorbar[id_figure5$CV_filter == "3"]
id_figure5$y_errorbar[id_figure5$CV_filter == "2"] <-
  id_figure5$y_errorbar[id_figure5$CV_filter == "2"]+
  id_figure5$y_errorbar[id_figure5$CV_filter == "3"]

figure5_turbo <- id_figure5 %>% filter(input != "10 ng")  %>% filter(scanning_mode == "Turbo") %>% 
  ggplot(aes(x = input, y = mean_id, fill = CV_filter))+
  geom_col(width = 0.7) +
 facet_grid(scanning_mode~injection_time)+
  labs(x = "",
       y = "Identified peptides",
       fill = "CV",
       title = "") +
  theme_bw() +
  theme(plot.title = element_text(size = 32, face = "bold",
                                  hjust = -0.09),
    axis.text = element_text(size = 24),
        axis.title = element_text(size = 27),
        strip.text = element_text(size = 27),
        strip.background = element_rect(fill = "#E5E4F7"),
        axis.title.y = element_text(vjust = 2.2),
        axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 1),
        legend.title = element_text(size = 27),
        axis.title.x = element_text(vjust = 0.2),
        legend.text = element_text(size = 27),
        legend.key.size = unit(0.9, "cm"))+
  scale_fill_manual(values = c("grey82", "#FF9090", "#FF3030"),
                    labels = c("\U2265 15%", "10 - 15%", "< 10%" ))+
  scale_y_continuous(limits = c(0, 16000))+
  geom_errorbar(aes(ymin = y_errorbar - sd_id, 
                         ymax = y_errorbar + sd_id),
                    width = 0.2,
                    size = 1)

```
Rapid
```{r}
id_figure5$y_errorbar <- id_figure5$mean_id
id_figure5$y_errorbar[id_figure5$CV_filter == "1"] <-
  id_figure5$y_errorbar[id_figure5$CV_filter == "1"] +
  id_figure5$y_errorbar[id_figure5$CV_filter == "2"]+
  id_figure5$y_errorbar[id_figure5$CV_filter == "3"]
id_figure5$y_errorbar[id_figure5$CV_filter == "2"] <-
  id_figure5$y_errorbar[id_figure5$CV_filter == "2"]+
  id_figure5$y_errorbar[id_figure5$CV_filter == "3"]

figure5_rapid <- id_figure5 %>% filter(input != "10 ng")  %>% filter(scanning_mode == "Rapid") %>% 
  ggplot(aes(x = input, y = mean_id, fill = CV_filter))+
  geom_col(width = 0.7) +
 facet_grid(scanning_mode~injection_time)+
  labs(x = "Input",
       y = "Identified peptides",
       fill = "CV",
       title = "") +
  theme_bw() +
  theme(legend.position = "none")+
  theme(plot.title = element_text(size = 32, face = "bold",
                                  hjust = -0.09),
    axis.text = element_text(size = 24),
        axis.title = element_text(size = 27),
        strip.text = element_text(size = 27),
        strip.background = element_rect(fill = "#E5E4F7"),
        axis.title.y = element_text(vjust = 2.2),
        axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 1),
        legend.title = element_text(size = 27),
        axis.title.x = element_text(vjust = 0.2),
        legend.text = element_text(size = 27),
        legend.key.size = unit(0.9, "cm"))+
scale_fill_manual(values = c("grey82", "#FF9090", "#FF3030"),
                    labels = c("\U2265 15%", "10 - 15%", "< 10%" ))+
  scale_y_continuous(limits = c(0, 16000))+
  geom_errorbar(aes(ymin = y_errorbar - sd_id, 
                         ymax = y_errorbar + sd_id),
                    width = 0.2,
                    size = 1)

```
Normal
```{r}
id_figure5$y_errorbar <- id_figure5$mean_id
id_figure5$y_errorbar[id_figure5$CV_filter == "1"] <-
  id_figure5$y_errorbar[id_figure5$CV_filter == "1"] +
  id_figure5$y_errorbar[id_figure5$CV_filter == "2"]+
  id_figure5$y_errorbar[id_figure5$CV_filter == "3"]
id_figure5$y_errorbar[id_figure5$CV_filter == "2"] <-
  id_figure5$y_errorbar[id_figure5$CV_filter == "2"]+
  id_figure5$y_errorbar[id_figure5$CV_filter == "3"]

figure5_normal <- id_figure5 %>% filter(input != "10 ng")  %>% filter(scanning_mode == "Normal") %>% 
  ggplot(aes(x = input, y = mean_id, fill = CV_filter))+
  geom_col(width = 0.7) +
 facet_grid(scanning_mode~injection_time)+
  labs(x = "Input",
       y = "",
       fill = "CV",
       title = "") +
  theme_bw() +
  theme(legend.position = "none")+
  theme(plot.title = element_text(size = 32, face = "bold",
                                  hjust = -0.09),
    axis.text = element_text(size = 24),
        axis.title = element_text(size = 27),
        strip.text = element_text(size = 27),
        strip.background = element_rect(fill = "#E5E4F7"),
        axis.title.y = element_text(vjust = 2.2),
        axis.text.x = element_text(angle = 90, vjust = 0.3, hjust = 1),
        legend.title = element_text(size = 27),
        axis.title.x = element_text(vjust = 0.2),
        legend.text = element_text(size = 27),
        legend.key.size = unit(0.9, "cm"))+
scale_fill_manual(values = c("grey82", "#FF9090", "#FF3030"),
                  labels = c("\U2265 15%", "10 - 15%", "< 10%" ))+
  scale_y_continuous(limits = c(0, 16000))+
  geom_errorbar(aes(ymin = y_errorbar - sd_id, 
                         ymax = y_errorbar + sd_id),  
                  width = 0.2,
                    size = 1)

```

#Join plots
Fig5 
```{r}
figure5 <- figure5_turbo/((figure5_rapid+figure5_normal)+plot_layout(widths = c(2,1)))
cairo_pdf(filename = "fig5.pdf", width = 20.83, height = 11.16)
figure5
dev.off()
```                    
Fig. 6 Improvement of the Number of Points Across Chromatographic Peaks
